<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Kariba: style-and-tips</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Kariba
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('md_style-and-tips.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">style-and-tips</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md33"></a>
Some style guidelines and tips</h1>
<h2><a class="anchor" id="autotoc_md34"></a>
Use the C++ standard library utilities</h2>
<p>In particular, containers such as std::vector, std::array, std::string, std::tuple, etc can be very useful, safe, and often faster.</p>
<p>Further, use C++ features: e.g., if you are using a struct to group variables, the struct can be declared and initialized C++ style, not so much C style:</p>
<div class="fragment"><div class="line">struct Params {</div>
<div class="line">  int a = 1;</div>
<div class="line">  double b = 0.0;</div>
<div class="line">};</div>
<div class="line">Params parameters;</div>
<div class="line">std::cout &lt;&lt; parameters.a &lt;&lt; &quot;\t&quot; &lt;&lt; parameters.b &lt;&lt; &quot;\n&quot;;</div>
<div class="line">Params parameters2{5};</div>
<div class="line">std::cout &lt;&lt; parameters2.a &lt;&lt; &quot;\t&quot; &lt;&lt; parameters2.b &lt;&lt; &quot;\n&quot;;</div>
</div><!-- fragment --><p>(the first line prints <code>1 -1</code>, the second <code>5 -1</code>.)</p>
<h2><a class="anchor" id="autotoc_md35"></a>
Keep your functions small</h2>
<p>If your functions start becoming 100 lines or more, or even exceed 50 lines, consider splitting it up in various subfunctions.</p>
<p>This has multiple advantages</p>
<ul>
<li>each function is more readable. This makes finding issues (bugs, or parts that can be improved) generally easier</li>
<li>it makes it easier to write unit tests for the functions</li>
<li>if the functions are members of a class, it is easier to create an overridden member function, so that only a particular algorithm may be altered, instead of having to copy-paste a 300-line function into a child class and only alter 5 lines.</li>
</ul>
<h2><a class="anchor" id="autotoc_md36"></a>
Docstrings</h2>
<p>Do write documentation strings. It always helps both your future slef and others to figure out what is going on in the respective function, or what variables are intended for (but clear variable names also help). Don't write what the code actually does (the infamous <code>i++; // increase i by 1</code> example), but write what the intent is, the underlying algorithm and possibly (a) reference(s).</p>
<p>The style for docstrings is Doxygen's Qt style, with docstrings starting with <code>/*!</code> or <code>//!</code>. See <a href="https://www.doxygen.nl/manual/docblocks.html">https://www.doxygen.nl/manual/docblocks.html</a> for some details, but generally, follow the overall style in the code.</p>
<h1><a class="anchor" id="autotoc_md37"></a>
Style</h1>
<p>This is a general style guide for writing code in the Kariba library. It can, of course, also be used outside of the library, but this is not necessary.</p>
<h3><a class="anchor" id="autotoc_md38"></a>
Use the formatter</h3>
<p>The code is formatted with <code>clang-format</code>; this tool can often be installed using a package manager. There is a <code>.clang-format</code> file with some definitions for the style (there are many more options). This ensures a consistent look and feel across the code.</p>
<p>In particular, it will:</p>
<ul>
<li>indent consistently (four spaces, except for private/public/protected identifiers)</li>
<li>break and wrap long lines</li>
<li>remove trailing whitespace</li>
<li>ensure a newline at the end of a file</li>
<li>add spaces around operands (e.g., <code>a=1+1</code> becomes <code>a = 1 + 1</code>).</li>
<li>add spaces before the opening parenthesis in if-statements and loops (<code>for(i=0</code> -&gt; <code>for (i = 0</code>)</li>
<li>add spaces after C-style casts (<code>(double)a</code> -&gt; (double) a`)</li>
<li>add some extra spaces for trailing comments (<code>a = 1; // comment</code> -&gt; <code>a = 1; // comment</code>)</li>
<li>create a consistent "hanging brace" style (with functions, if statements and loops)</li>
<li>add braces around single-line if statements</li>
</ul>
<p>The various whitespace additions are to make the code (and comments) hopefully more readable.</p>
<h3><a class="anchor" id="autotoc_md39"></a>
Class, function and variable names</h3>
<p>Class names follow PascalCase: each (sub)word is started with a capital. This is done in a rather relaxed manner: <code>BBody</code> instead of <code>BlackBody</code>, <code>Powerlaw</code> and <code>Cyclosyn</code> instead of <code>PowerLaw</code> and <code>CycloSyn</code>.</p>
<p>Function and variable names are snake_case: use underscores to separate parts of the function. The underscore tends to read better (more space) than with camelCase, where long names can become cumbersome to read (<code>a_very_long_variable_name</code> vs <code>aVeryLongVariableName</code>).</p>
<h1><a class="anchor" id="autotoc_md40"></a>
Header / include files</h1>
<p>Include header files only where they are needed: sometimes, they are needed only in the cpp file, so don't include them in the related hpp file. If both files need them, include them in both.</p>
<p>Be aware that the order of header files shouldn't matter. In fact, clang-format will order the header files alphabetically.</p>
<hr  />
<p>An example of the latter where the order of include files causes a problem:</p>
<ul>
<li><code>a.h</code> includes <code>&lt;vector&gt;</code></li>
<li><code>b.h</code> defines a function <code>func</code> using <code>std::vector</code> (as return type of one of its arguments), but does not include <code>&lt;vector&gt;</code>.</li>
<li><code>c.cpp</code> includes <code>a.h</code> before <code>b.h</code> (and doesn't include <code>vector</code> itself). Therefore, when the preprocessor has finished, the <code>&lt;vector&gt;</code> is included before <code>func</code> is defined, and the compilation works fine.</li>
<li>If <code>c.cpp</code> includes <code>b.h</code> before <code>a.h</code>, after the preprocessing stage, <code>func</code> is defined before <code>vector</code> is included, and the compilation will fail.</li>
</ul>
<h1><a class="anchor" id="autotoc_md42"></a>
Unit tests</h1>
<p>Try and include some basic unit tests with your new functionality. Take care of covering edge cases, such as NaN or infinity in the input, out-of-range values as input, empty inputs (0-size vectors) and other edge cases. A few basic tests can cover the normal cases.</p>
<p>See the EBL unit tests as an example of covering edge cases, and running a few tests for more normal cases. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
